<html>

<head>
	
	<h1> Squat Lab </h1>
	
</head>


<body>
	
	<canvas id="myCanvas" width="200" height="100" style="border:1px solid #000000;">
	</canvas> 
	<br>

	<label for="r12in"> foot length </label>
	<input id="r12in" type="range">
	<output id="r12out" for="r12in">  </output>
	<br>
	
	<label for="r23in"> shin length </label>
	<input id="r23in" type="range">
	<output id="r23out" for="r23in">  </output>
	<br>
	
	<label for="r34in"> thigh length </label>
	<input id="r34in" type="range">
	<output id="r34out" for="r34in">  </output>
	<br>
	
	<label for="r45in"> torso length </label>
	<input id="r45in" type="range">
	<output id="r45out" for="r45in">  </output>
	<br>
	
	<br>
	
	<label for="kneein"> knee/(knee+hip) torque </label>
	<input id="kneein" type="range">
	<output id="kneeout" for="kneein">  </output>
	<br>
	
	<label for="alphain"> thigh angle </label>
	<input id="alphain" type="range">
	<output id="alphaout" for="alphain">  </output>
	<br>
	
</body>


<script>
	
	
	var width = 600;
	var height = 300;
	var ctx = document.getElementById("myCanvas").getContext("2d");
	var x0 = width*0.5;
	var y0 = height*0.75;
	var r12 = 20;
	var r23 = 50;
	var r34 = 40;
	var r45 = 75;
	
	//var phi = 45*2*Math.PI/360;
	var alpha = 0;
	var knee = 100;
	
	var x1,y1,x2,y2,x3,y3,x4,y4,x5,y5;
	
	
	var img = new Image();
	img.src = 'Unbenannt.gif';
	
	
	window.onload = atStart;
	document.getElementById("r12in").addEventListener("input",update);
	document.getElementById("r23in").addEventListener("input",update);
	document.getElementById("r34in").addEventListener("input",update);
	document.getElementById("r45in").addEventListener("input",update);
	document.getElementById("kneein").addEventListener("input",update);
	document.getElementById("alphain").addEventListener("input",update);
	
	function atStart()
	{	
		// initialize
		document.getElementById("myCanvas").width = width; 
		document.getElementById("myCanvas").height = height; 
		
		document.getElementById("r12in").value = r12; 
		document.getElementById("r12in").max = 2*r12; 
		//document.getElementById("r12in").min = 0.5*r12; 
		
		document.getElementById("r23in").value = r23; 
		document.getElementById("r23in").max = 2*r23; 
		//document.getElementById("r23in").min = 0.5*r23; 
		
		document.getElementById("r34in").value = r34; 
		document.getElementById("r34in").max = 2*r34; 
		//document.getElementById("r34in").min = 0.5*r34; 
		
		document.getElementById("r45in").value = r45; 
		document.getElementById("r45in").max = 2*r45; 
		//document.getElementById("r45in").min = 0.5*r45; 
		
		document.getElementById("kneein").value = 0.5*knee; 
		document.getElementById("kneein").max = 1.0*knee; 
		document.getElementById("kneein").min = -0.25*knee; 
		
		document.getElementById("alphain").value = 0; 
		document.getElementById("alphain").max = 95; 
		document.getElementById("alphain").min = -15;
		
		update();

	}
	
	function update()
	{		 
		r12 = document.getElementById("r12in").value; 
		document.getElementById("r12out").innerHTML = r12 + "cm";
	 
		r23 = document.getElementById("r23in").value; 
		document.getElementById("r23out").innerHTML = r23 + "cm";
	 
		r34 = document.getElementById("r34in").value; 
		document.getElementById("r34out").innerHTML = r34 + "cm";

		r45 = document.getElementById("r45in").value; 
		document.getElementById("r45out").innerHTML = r45 + "cm";
		
		knee = document.getElementById("kneein").value; 
		document.getElementById("kneeout").innerHTML = knee + "%";
		
		alpha = document.getElementById("alphain").value; 
		document.getElementById("alphaout").innerHTML = alpha + "Â°";
		
		draw();
	}
	
	
	function draw()
	{
		
		calcPoints();
		
		ctx.clearRect(0, 0, width, height); 
		
		ctx.beginPath();
		ctx.moveTo(x1, y1);
		ctx.lineTo(x2, y2);
		ctx.lineTo(x3, y3);
		ctx.lineTo(x4, y4);
		ctx.lineTo(x5, y5);
		ctx.stroke(); 
		
		ctx.beginPath();
		ctx.arc(x5, y5, 10, 0, 2 * Math.PI);
		ctx.fill(); 		
		ctx.stroke(); 
		
		ctx.beginPath();
		ctx.arc(x2, y2, 10, - Math.PI/16 - Math.atan((y2-y3)/(x3-x2)), Math.PI/16 + Math.atan((y2-y1)/(x2-x1)));		
		ctx.stroke(); 
		
		ctx.beginPath();
		//ctx.arc(x3, y3, 10, -Math.PI - 0*Math.PI/16 - Math.atan((y3-y4)/(x4-x3)), -Math.PI + 0*Math.PI/16 + Math.atan((y3-y2)/(x3-x2)));		
		ctx.arc(x3, y3, 10, -Math.PI - Math.PI/16 + Math.atan((y3-y2)/(x3-x2)), -Math.PI + Math.PI/16 - Math.atan((y3-y4)/(x4-x3)));		
		ctx.stroke(); 
		
		ctx.beginPath();
		ctx.arc(x4, y4, 10, - Math.PI/16 - Math.abs(Math.atan((y4-y5)/(x5-x4))), Math.PI/16 + Math.atan((y4-y3)/(x4-x3)));		
		ctx.stroke(); 
		
		
		ctx.rotate(alpha*Math.PI/180);
		
		ctx.drawImage(img, 100, 100);
		ctx.rotate(-alpha*Math.PI/180);
		
		
		
	}
	
	function calcPoints()
	{
		x1 = x0+0.5*r12;
		y1 = y0;
		
		x2 = x0-0.5*r12;
		y2 = y0;
		
		//x3 = x2+r12*knee/100;
		//y3 = y2-Math.pow(r23*r23-(x3-x2)*(x3-x2),0.5);
		
		x3 = x0+(knee/100)*r34*Math.cos(alpha*2*Math.PI/360);
		y3 = y2-Math.pow(r23*r23-(x3-x2)*(x3-x2),0.5);
		
		//x4 = x3-r34*Math.cos(alpha*2*Math.PI/360);
		//y4 = y3-r34*Math.sin(alpha*2*Math.PI/360);
		
		x4 = x0-(1-knee/100)*r34*Math.cos(alpha*2*Math.PI/360);
		if (alpha>0)
			y4 = y3-Math.pow(r34*r34-(x4-x3)*(x4-x3),0.5);
		else
			y4 = y3+Math.pow(r34*r34-(x4-x3)*(x4-x3),0.5);
		
		x5 = x0;
		y5 = y4-Math.pow(r45*r45-(x5-x4)*(x5-x4),0.5);
			
	}
	
	
</script>

</html>

